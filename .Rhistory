ggplot(sightings_summary, aes(x = year, y = sightings, group = year))+
geom_point()+
geom_path()
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(angle=60, hjust=1))
ggplot(sightings_summary, aes(x = year, y = sightings))+
geom_point()+
geom_path()
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(angle=60, hjust=1))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point()+
geom_path()
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(angle=60, hjust=1))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point()+
geom_path()+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(angle=60, hjust=1))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1, color = year))+
geom_point()+
geom_path()+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(angle=60, hjust=1))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point()+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(angle=60, hjust=1))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point()+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(size = 8,angle=60, hjust=1))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point()+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(size= 6,angle=60, hjust=1))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point()+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(size= 6,angle=70, hjust=1))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point()+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(size= 6,angle=70, hjust=0.5))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point()+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point(size = 2)+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point(size = 0.5)+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point(size = 1)+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point(size = 1)+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_x_continuous(breaks = seq(1910,2014, by = 5))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point(size = 1)+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_x_continuous(breaks = seq(1910,2014, by = 5))+
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point(size = 1)+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_x_discrete(breaks = seq(1910,2014, by = 5))+
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point(size = 1)+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_x_discrete(breaks = seq(1910,2014, by = 3))+
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point(size = 1)+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_x_discrete(breaks = seq(1910,2014, by = 2.5))+
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point(size = 1)+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_x_discrete(breaks = seq(1910,2014, by = 1))+
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point(size = 1)+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_x_discrete(breaks = seq(1910,2014, by = 10))+
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point(size = 1)+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_x_discrete(breaks = seq(1910,2014, by = 5))+
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point(size = 1)+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_x_discrete(breaks = seq(1910,2014, by = 3))+
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_boxplot()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_tile()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_tile()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
scale_fill_viridis_c() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5 hjust = 1))
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_tile()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
scale_fill_viridis_c() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5 hjust = 1)
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_tile()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
scale_fill_viridis_c() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1)
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_tile()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
scale_fill_viridis_c() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs, fill = avg_secs))+
geom_tile()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
scale_fill_viridis_c() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
ggplot(ufo2_avg_time, (aes(x = state, y = 1, fill = avg_secs))+
geom_tile()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
scale_fill_viridis_c() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
ggplot(ufo2_avg_time, aes(x = state, y = 1, fill = avg_secs))+
geom_tile()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
scale_fill_viridis_c() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1))
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_col()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2 %>%
group_by(state) %>%
summarise(n_sightings = n()) %>%
arrange(desc(n_sightings)) %>%
ggplot(aes(x = state, y = n_sightings))+
geom_col()+
coord_flip()+
labs(title = "Total Recorded UFO Sightings by State",
x = "State",
y= "Number of Sightings")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
knitr::opts_chunk$set(echo = TRUE)
#install.packages("paletteer")
library("tidyverse")
library("naniar")
library("janitor")
library("ggmap")
library("dplyr")
library("RColorBrewer")
library("paletteer")
ufo <- readr::read_csv("ufo_data/complete.csv", na = c("", "unkown")) %>% clean_names
glimpse(ufo)
summary(ufo)
ufo2 <- ufo %>%
separate(datetime, into = c("day", "month","year"), sep="/") %>%
separate(year, into = c("year", "time"), sep = " ") %>%
select(-duration_hours_min, -comments, -date_posted) %>%
mutate(year=as.factor(year)) %>%
mutate(latitude=as.numeric(latitude)) %>%
mutate(longitude=as.numeric(longitude)) %>%
mutate(shape=as.factor(shape)) %>%
mutate(state=as.factor(state)) %>%
filter(country=="us", latitude!=0, longitude!=0)
ufo2
#I tried to condense all the data set pre-processing under this one chunk. It seems to work, but it gives an error though idk why :/
register_stadiamaps("aff428bd-8ad7-4b69-8b6b-b34301483ba9", write = FALSE)
ufo2 %>%
select(latitude, longitude) %>%
summary()
latitude <- c(17.97, 70.67)
longitude <- c(-176.66, -65.83)
alien_bbox <- make_bbox(longitude, latitude, f = 0.03)
alien_map <-  get_stadiamap(alien_bbox, maptype = "stamen_terrain", zoom=5)
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude), size=0.1) +
labs(x= "Longitude", y= "Latitude", title="UFO Sightings in the U.S")
names(ufo2)
ufo2 %>%
group_by(year) %>%
summarise(sightings = n()) %>%
arrange(desc(sightings))
sightings_summary <- ufo2 %>%
filter(!is.na(year)) %>%
group_by(year) %>%
summarise(sightings = n())
sightings_summary$sightings <- as.numeric(sightings_summary$sightings)
ggplot(sightings_summary, aes(x = year, y = sightings, group = 1))+
geom_point(size = 1)+
geom_path(color = "blue")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_x_discrete(breaks = seq(1910,2014, by = 3))+
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ufo2_avg_time <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0)) %>%
group_by(state) %>%
summarise(avg_secs = mean(duration_seconds)) %>%
arrange(desc(avg_secs))
ufo2_avg_time
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_col()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2 %>%
group_by(state) %>%
summarise(n_sightings = n()) %>%
arrange(desc(n_sightings))
ufo2 %>%
group_by(state) %>%
summarise(n_sightings = n()) %>%
arrange(desc(n_sightings)) %>%
ggplot(aes(x = state, y = n_sightings))+
geom_col()+
labs(title = "Total Recorded UFO Sightings by State",
x = "State",
y= "Number of Sightings")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2 %>%
group_by(shape) %>%
summarise(n_sightings = n()) %>%
arrange(desc(n_sightings))
ufo2 %>%
filter(!is.na(shape)) %>%
group_by(shape) %>%
summarise(n_sightings = n()) %>%
arrange(desc(n_sightings)) %>%
ggplot(aes(x = shape, y = n_sightings))+
geom_col()+
labs(title = "Total Recorded UFO Sightings by Sighting Shape",
x = "Shape",
y= "Number of Sightings")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#why are there still unknowns here?
View(ufo2_avg_time)
ufo2_avg_time <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0)) %>%
group_by(state, shape) %>%
summarise(avg_secs = mean(duration_seconds)) %>%
arrange(desc(avg_secs))
ufo2_avg_time
ufo2_avg_time <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0)) %>%
group_by(state, shape, na.rm = T) %>%
summarise(avg_secs = mean(duration_seconds)) %>%
arrange(desc(avg_secs))
ufo2_avg_time
ufo2_avg_time <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0) na.rm = T) %>%
ufo2_avg_time <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0), na.rm = T) %>%
group_by(state, shape) %>%
summarise(avg_secs = mean(duration_seconds)) %>%
arrange(desc(avg_secs))
ufo2_avg_time <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0) & !is.na(shape)) %>%
group_by(state, shape) %>%
summarise(avg_secs = mean(duration_seconds)) %>%
arrange(desc(avg_secs))
ufo2_avg_time
ufo2_avg_time <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0) & !is.na(shape)) %>%
group_by(state, shape) %>%
summarise(avg_secs = mean(duration_seconds)) %>%
arrange(desc(avg_secs))
ufo2_avg_time
ggplot(ufo2_avg_time, aes(x = shape, y = avg_secs)) +
geom_boxplot(fill = "skyblue", color = "black") +  # Adjust fill and color as needed
labs(title = "Distribution of Sighting Durations by Shape", x = "Shape", y = "Duration (seconds)") +
theme_minimal()
ggplot(ufo2_avg_time, aes(x = shape, y = avg_secs)) +
geom_col(fill = "skyblue", color = "black") +  # Adjust fill and color as needed
labs(title = "Distribution of Sighting Durations by Shape", x = "Shape", y = "Duration (seconds)") +
theme_minimal()
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_col()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(ufo2_avg_time, aes(x = shape, y = avg_secs)) +
geom_col(fill = "skyblue", color = "black") +  # Adjust fill and color as needed
labs(title = "Distribution of Sighting Durations by Shape", x = "Shape", y = "Duration (seconds)") +
theme_minimal()+
theme(axis.text.x=element_text(size= 7.5,angle=70, hjust=0.5))
ufo2 %>%
filter(!is.na(shape)) %>%
group_by(shape) %>%
summarise(n_sightings = n()) %>%
arrange(desc(n_sightings)) %>%
ggplot(aes(x = shape, y = n_sightings))+
geom_col()+
labs(title = "Total Recorded UFO Sightings by Sighting Shape",
x = "Shape",
y= "Number of Sightings")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#why are there still unknowns here?
ggplot(ufo2, aes(x = longitude, y = latitude)) +
geom_tile(stat = "density2d", aes(fill = ..density..), color = "white") +
scale_fill_viridis_c() +  # Choose a color scale
labs(title = "Heatmap of UFO Sightings", x = "Longitude", y = "Latitude", fill = "Density") +
theme_minimal()
ggplot(ufo2, aes(x = longitude, y = latitude)) +
geom_tile(stat = "density2d", aes(fill = after_stat(density)), color = "white") +
scale_fill_viridis_c() +  # Choose a color scale
labs(title = "Heatmap of UFO Sightings", x = "Longitude", y = "Latitude", fill = "Density") +
theme_minimal()
ggplot(ufo2, aes(x = longitude, y = latitude)) +
geom_tile(stat = "density2d", aes(fill = after_stat(density)), color = "white") +
scale_fill_viridis_c() +  # Choose a color scale
labs(title = "Heatmap of UFO Sightings", x = "Longitude", y = "Latitude", fill = "Density") +
theme_minimal()
ggplot(ufo2, aes(x = longitude, y = latitude)) +
geom_tile(stat = "density2d", aes(fill = ..density..), color = "white") +
scale_fill_viridis_c() +  # Choose a color scale
labs(title = "Heatmap of UFO Sightings", x = "Longitude", y = "Latitude", fill = "Density") +
theme_minimal()
ggmap(alien_map)
heatmap <- ggplot(data, aes(x = longitude, y = latitude)) +
geom_tile(stat = "density2d", aes(fill = after_stat(density)), color = "white") +
scale_fill_viridis_c() +  # Choose a color scale
labs(title = "Heatmap of UFO Sightings", x = "Longitude", y = "Latitude", fill = "Density") +
theme_minimal() +
theme(axis.title = element_blank(), axis.text = element_blank(), axis.ticks = element_blank(),
panel.grid = element_blank(), legend.position = "bottom")
heatmap <- ggplot(ufo2, aes(x = longitude, y = latitude)) +
geom_tile(stat = "density2d", aes(fill = after_stat(density)), color = "white") +
scale_fill_viridis_c() +  # Choose a color scale
labs(title = "Heatmap of UFO Sightings", x = "Longitude", y = "Latitude", fill = "Density") +
theme_minimal() +
theme(axis.title = element_blank(), axis.text = element_blank(), axis.ticks = element_blank(),
panel.grid = element_blank(), legend.position = "bottom")
# Plot the ggmap
ggmap(alien_map) +
annotation_raster(heatmap, xmin = min(data$longitude), xmax = max(data$longitude),
ymin = min(data$latitude), ymax = max(data$latitude))
heatmap <- ggplot(ufo2, aes(x = longitude, y = latitude)) +
geom_tile(stat = "density2d", aes(fill = after_stat(density)), color = "white") +
scale_fill_viridis_c() +  # Choose a color scale
labs(title = "Heatmap of UFO Sightings", x = "Longitude", y = "Latitude", fill = "Density") +
theme_minimal() +
theme(axis.title = element_blank(), axis.text = element_blank(), axis.ticks = element_blank(),
panel.grid = element_blank(), legend.position = "bottom")
# Plot the ggmap
ggmap(alien_map) +
annotation_raster(heatmap, xmin = min(data$longitude), xmax = max(ufo2$longitude),
ymin = min(ufo2$latitude), ymax = max(ufo2$latitude))
heatmap <- ggplot(ufo2, aes(x = longitude, y = latitude)) +
geom_tile(stat = "density2d", aes(fill = after_stat(density)), color = "white") +
scale_fill_viridis_c() +  # Choose a color scale
labs(title = "Heatmap of UFO Sightings", x = "Longitude", y = "Latitude", fill = "Density") +
theme_minimal() +
theme(axis.title = element_blank(), axis.text = element_blank(), axis.ticks = element_blank(),
panel.grid = element_blank(), legend.position = "none")
# Convert heatmap plot to a raster image
heatmap_raster <- grid.grab(ggplotGrob(heatmap))
heatmap <- ggplot(ufo2, aes(x = longitude, y = latitude)) +
geom_tile(stat = "density2d", aes(fill = after_stat(density)), color = "white") +
scale_fill_viridis_c() +  # Choose a color scale
labs(title = "Heatmap of UFO Sightings", x = "Longitude", y = "Latitude", fill = "Density") +
theme_minimal() +
theme(axis.title = element_blank(), axis.text = element_blank(), axis.ticks = element_blank(),
panel.grid = element_blank(), legend.position = "none")
# Convert heatmap plot to a raster image
grob <- ggplotGrob(heatmap)
heatmap_raster <- grid.raster(grob)
ggplot(ufo2, aes(x = longitude, y = latitude)) +
geom_tile(stat = "density2d", aes(fill = ..density..), color = "white") +
scale_fill_viridis_c() +  # Choose a color scale
labs(title = "Heatmap of UFO Sightings", x = "Longitude", y = "Latitude", fill = "Density") +
theme_minimal()
