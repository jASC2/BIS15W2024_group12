knitr::opts_chunk$set(echo = TRUE)
library("tidyverse")
library("naniar")
library("janitor")
ufo <- readr::read_csv("ufo_data/complete.csv", na = c("", "unkown")) %>% clean_names
ufo2 <- ufo %>%
separate(datetime, into = c("day", "month","year"), sep="/") %>%
separate(year, into = c("year", "time"), sep = " ") %>%
select(-duration_hours_min, -comments, -date_posted) %>%
filter(country=="us")
ufo2
View(ufo2)
ufo2 %>%
select(latitude, longitude) %>%
summary()
ufo %>%
select(latitude, longitude) %>%
summary()
ufo2$latitude <- as.numeric(ufo2$latitude)
ufo2$longitude <- as.numeric(ufo2$longitude)
ufo %>%
select(latitude, longitude) %>%
summary()
ufo2 %>%
select(latitude, longitude) %>%
summary()
register_stadiamaps("aff428bd-8ad7-4b69-8b6b-b34301483ba9", write = FALSE)
library("tidyverse")
library("naniar")
library("janitor")
library("ggmap"")
library("tidyverse")
library("naniar")
library("janitor")
library("ggmap")
register_stadiamaps("aff428bd-8ad7-4b69-8b6b-b34301483ba9", write = FALSE)
latitude <- c(17.97, 70.67)
longitude <- c(-176.66, -65.83)
alien_bbox <- make_bbox(longitude, latitude, f = 0.03)
alien_map <-  get_stadiamap(bbox_grizzly, maptype = "stamen_terrain", zoom=4)
alien_map <-  get_stadiamap(alien_bbox, maptype = "stamen_terrain", zoom=4)
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude), size=0.5) +
labs(x= "Longitude", y= "Latitude", title="Alien Sightings in the U.S")
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude), size=0.2) +
labs(x= "Longitude", y= "Latitude", title="Alien Sightings in the U.S")
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude, color = state), size=0.2) +
labs(x= "Longitude", y= "Latitude", title="Alien Sightings in the U.S")
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude, color = time), size=0.2) +
labs(x= "Longitude", y= "Latitude", title="Alien Sightings in the U.S")
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude, color = month), size=0.2) +
labs(x= "Longitude", y= "Latitude", title="Alien Sightings in the U.S")
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude), size=0.2) +
labs(x= "Longitude", y= "Latitude", title="Alien Sightings in the U.S")
alien_map <-  get_stadiamap(alien_bbox, maptype = "terrain-lines", zoom=4)
alien_map <-  get_stadiamap(alien_bbox, maptype = "outdoors", zoom=4)
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude), size=0.2) +
labs(x= "Longitude", y= "Latitude", title="Alien Sightings in the U.S")
alien_map <-  get_stadiamap(alien_bbox, maptype = "stamen_watercolor", zoom=4)
alien_map <-  get_stadiamap(alien_bbox, maptype = "stamen_terrain", zoom=4)
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude), size=0.2) +
labs(x= "Longitude", y= "Latitude", title="Alien Sightings in the U.S")
alien_map <-  get_stadiamap(alien_bbox, maptype = "stamen_terrain", zoom=5)
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude), size=0.2) +
labs(x= "Longitude", y= "Latitude", title="Alien Sightings in the U.S")
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude), size=0.1) +
labs(x= "Longitude", y= "Latitude", title="Alien Sightings in the U.S")
ufo2 %>%
count(year)
ufo2 %>%
count(year) %>%
arrange(desc(year))
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude, color = year), size=0.1) +
labs(x= "Longitude", y= "Latitude", title="Alien Sightings in the U.S")
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude), size=0.1) +
labs(x= "Longitude", y= "Latitude", title="Alien Sightings in the U.S")
ufo2 %>%
group_by(year) %>%
ufo2 %>%
group_by(year) %>%
summarise(max_year = max(year),
year_totals = n()) %>%
```
ufo2 %>%
group_by(year) %>%
summarise(max_year = max(year),
year_totals = n()) %>%
arrange(desc(max_year))
ufo2 %>%
group_by(year) %>%
summarise(max_year = max(year)) %>%
arrange(desc(max_year))
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude), size=0.1) +
labs(x= "Longitude", y= "Latitude", title="Alien Sightings in the U.S")
names(ufo2)
is.numeric(ufo2$year)
ufo2$year <- as.numeric(ufo2$year)
sightings_per_yr <- aggregate((n ~ year, data= ufo2, FUN = length))
sightings_summary <- ufo2 %>%
group_by(year) %>%
summarise(sightings = n())
View(sightings_summary)
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude), size=0.1) +
labs(x= "Longitude", y= "Latitude", title="UFO Sightings in the U.S")
sightings_summary %>%
ggplot(aes(x = year, y = sightings))+
geom_line()+
labs(title = "UFO Sightings Over the Years")
sightings_summary %>%
ggplot(aes(x = year, y = sightings))+
geom_col()+
labs(title = "UFO Sightings Over the Years")
sightings_summary %>%
ggplot(aes(x = year, y = sightings))+
geom_line()+
labs(title = "UFO Sightings Over the Years")
theme()
library(ggplot)
library(ggplot2)
theme()
sightings_summary %>%
ggplot(aes(x = year, y = sightings))+
geom_col()+
labs(title = "UFO Sightings Over the Years")+
theme()
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col()+
labs(title = "UFO Sightings Over the Years")+
theme_dark()
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col()+
labs(title = "UFO Sightings Over the Years")+
theme_minimal()
sightings_summary <- ufo2 %>%
group_by(year, state) %>%
summarise(sightings = n())
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year, fill = state))+
geom_col()+
labs(title = "UFO Sightings Over the Years")+
theme_minimal()
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col()+
labs(title = "UFO Sightings Over the Years")+
theme_minimal()
sightings_summary <- ufo2 %>%
group_by(year) %>%
summarise(sightings = n())
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col()+
labs(title = "UFO Sightings Over the Years")+
theme_minimal()
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col()+
labs(title = "UFO Sightings Over the Years")+
theme_bw()
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years")+
theme_bw()
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)")+
theme_bw()
is.numeric(ufo2$duration_seconds)
ufo2 %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_boxplot()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds")
ufo2 %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_boxplot()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds"))
ufo2 %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_boxplot()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")
ufo2 %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_boxplot(na.rm = T)+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")
ufo2 %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_col(na.rm = T)+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")
ufo2 %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_col(na.rm = T)+
coord_flip()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")
ufo2 %>%
ggplot(aes(x = state, y = duration_seconds, na.rm = T))+
geom_col(na.rm = T)+
coord_flip()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")
ufo2 %>%
filter(!is.na(duration_seconds))
ggplot(aes(x = state, y = duration_seconds))+
geom_col()+
coord_flip()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")
ufo2_clean <- ufo2 %>%
filter(!is.na())
ufo2_clean <- ufo2 %>%
filter(!is.na(duration_seconds))
ufo2_clean %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_col()+
coord_flip()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")
ufo2_clean %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_col()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")
ufo2_clean %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_col()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text = element_text(angle = 45, hjust = 1))
ufo2_clean %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_col()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2_clean %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_col()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 0.5))
ufo2_clean %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_col()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2_clean <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0))
ufo2_clean %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_col()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2_clean <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0)) %>%
group_by(state) %>%
summarise(avg_secs = mean(duration_seconds))
ufo2_clean %>%
ggplot(aes(x = state, y = duration_seconds))+
geom_col()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2_clean %>%
ggplot(aes(x = state, y = avg_secs))+
geom_col()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2_avg_time <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0)) %>%
group_by(state) %>%
summarise(avg_secs = mean(duration_seconds))
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_col()+
labs(title = "Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
sightings_summary <- ufo2 %>%
group_by(year) %>%
summarise(sightings = n()) %>%
arrange(desc())
sightings_summary <- ufo2 %>%
group_by(year) %>%
summarise(max_year = max(year),
sightings = n()) %>%
arrange(desc(max_year))
sightings_summary <- ufo2 %>%
group_by(year) %>%
summarise(sightings = n())
ufo2 %>%
group_by(year) %>%
summarise(sightings = n()) %>%
arrange(desc(sightings))
