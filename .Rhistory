summarise(max_year = max(year),
sightings = n()) %>%
arrange(desc(max_year))
sightings_summary <- ufo2 %>%
group_by(year) %>%
summarise(sightings = n())
ufo2 %>%
group_by(year) %>%
summarise(sightings = n()) %>%
arrange(desc(sightings))
knitr::opts_chunk$set(echo = TRUE)
library("tidyverse")
library("naniar")
library("janitor")
library("ggmap")
library("dplyr")
ufo <- readr::read_csv("ufo_data/complete.csv", na = c("", "unkown")) %>% clean_names
glimpse(ufo)
ufo2 <- ufo %>%
separate(datetime, into = c("day", "month","year"), sep="/") %>%
separate(year, into = c("year", "time"), sep = " ") %>%
select(-duration_hours_min, -comments, -date_posted) %>%
filter(country=="us")
ufo2
register_stadiamaps("aff428bd-8ad7-4b69-8b6b-b34301483ba9", write = FALSE)
ufo2$latitude <- as.numeric(ufo2$latitude)
ufo2$longitude <- as.numeric(ufo2$longitude)
ufo2 %>%
select(latitude, longitude) %>%
summary()
latitude <- c(17.97, 70.67)
longitude <- c(-176.66, -65.83)
alien_bbox <- make_bbox(longitude, latitude, f = 0.03)
alien_map <-  get_stadiamap(alien_bbox, maptype = "stamen_terrain", zoom=5)
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude), size=0.1) +
labs(x= "Longitude", y= "Latitude", title="UFO Sightings in the U.S")
names(ufo2)
ufo2$year <- as.numeric(ufo2$year)
ufo2 %>%
group_by(year) %>%
summarise(sightings = n()) %>%
arrange(desc(sightings))
sightings_summary <- ufo2 %>%
group_by(year) %>%
summarise(sightings = n())
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)")+
theme_bw()
ufo2_avg_time <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0)) %>%
group_by(state) %>%
summarise(avg_secs = mean(duration_seconds))
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_col()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
sightings_summary %>%
ggplot(aes(x = as.factor(year, y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)")+
theme_bw()
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_fill_brewer(palette = "Set2")+
theme_minial()+
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14, face = "bold"))
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_fill_brewer(palette = "Set2")+
theme_minimal()+
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14, face = "bold"))
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_fill_brewer(palette = "Set2")+
theme_minimal()
display.brewer.all()
colors <- paletteer::palettes_d_names
library("tidyverse")
library("naniar")
library("janitor")
library("ggmap")
library("dplyr")
library(RColorBrewer)
library(paletteer)
install.packages("paleteer")
install.packages("paletteer")
library("tidyverse")
library("naniar")
library("janitor")
library("ggmap")
library("dplyr")
library(RColorBrewer)
library(paletteer)
colors <- paletteer::palettes_d_names
View(colors)
my_palette <- paletteer_d("ggsci:deep_purple_material")
my_palette <- paletteer_d("werpals::monet")
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
scale_fill_brewer(palette = my_palette)+
theme_minimal()
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
scale_x_discrete(labels = function(x) ifelse(as.numeric(x) %% 10 == 0, x, ""))
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()+
scale_x_discrete(breaks = seq(1910, 2014, by = 10))
sightings_summary %>%
ggplot(aes(x = year, y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
sightings_summary %>%
ggplot(aes(x = as.factor(year), y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
sightings_summary %>%
ggplot(aes(x = as.factor(year, levels = seq(1910, 2014, by = 10)), y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
sightings_summary %>%
ggplot(aes(x = factor(year, levels = seq(1910, 2014, by = 10)), y = sightings, group = year))+
geom_col(position = "dodge")+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
sightings_summary %>%
ggplot(aes(x = factor(year, levels = seq(1910, 2014, by = 10)), y = sightings, group = year))+
geom_col(position = "dodge", na.rm = T)+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
sightings_summary %>%
ggplot(aes(x = factor(year, levels = seq(1910, 2014, by = 10)), y = sightings, group = year, na.rm = T))+
geom_col(position = "dodge", na.rm = T)+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
sightings_summary %>%
ggplot(aes(x = factor(year, levels, y = sightings, group = year, na.rm = T))+
geom_col(position = "dodge", na.rm = T)+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
sightings_summary %>%
ggplot(aes(x = factor(year, levels = seq(1910, 2014, by = 5)), y = sightings, group = year, na.rm = T))+
geom_col(position = "dodge", na.rm = T)+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
sightings_summary <- ufo2 %>%
filter(!is.na(year)) %>%
group_by(year) %>%
summarise(sightings = n())
sightings_summary %>%
ggplot(aes(x = factor(year, levels = seq(1910, 2014, by = 5)), y = sightings, group = year, na.rm = T))+
geom_col(position = "dodge", na.rm = T)+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
ggplot(sightings_summary, aes(x = year, y = sightings, group = year, na.rm = T))+
geom_col(position = "dodge", na.rm = T)+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
ggplot(sightings_summary, aes(x = year, y = sightings, group = year, na.rm = T))+
geom_line(position = "dodge", na.rm = T)+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
ggplot(sightings_summary, aes(x = year, y = sightings, group = year))+
geom_line()+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
ggplot(sightings_summary, aes(x = year, y = sightings))+
geom_line()+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
library("tidyverse")
library("naniar")
library("janitor")
library("ggmap")
library("dplyr")
library("RColorBrewer")
library("paletteer")
ufo <- readr::read_csv("ufo_data/complete.csv", na = c("", "unkown")) %>% clean_names
View(ufo)
glimpse(ufo)
summary(ufo)
ufo2 <- ufo %>%
separate(datetime, into = c("day", "month","year"), sep="/") %>%
separate(year, into = c("year", "time"), sep = " ") %>%
select(-duration_hours_min, -comments, -date_posted) %>%
filter(country=="us")
ufo2
View(ufo2)
ufo2 <- ufo %>%
separate(datetime, into = c("day", "month","year"), sep="/") %>%
separate(year, into = c("year", "time"), sep = " ") %>%
select(-duration_hours_min, -comments, -date_posted) %>%
mutate(year==as.factor(year)) %>%
mutate(latitude==as.numeric(latitude)) %>%
mutate(latitude==as.numeric(longitude)) %>%
mutate(shape==as.factor(shape)) %>%
mutate(state==as.factor(state)) %>%
filter(country=="us", latitude != 0, longitude !=0)
ufo2
ufo2 <- ufo %>%
separate(datetime, into = c("day", "month","year"), sep="/") %>%
separate(year, into = c("year", "time"), sep = " ") %>%
select(-duration_hours_min, -comments, -date_posted) %>%
mutate(year==as.factor(year)) %>%
mutate(latitude==as.numeric(latitude)) %>%
mutate(longitude==as.numeric(longitude)) %>%
mutate(shape==as.factor(shape)) %>%
mutate(state==as.factor(state)) %>%
filter(country=="us", latitude != 0, longitude !=0)
ufo2
?as.factor()
View(ufo2)
ufo2 <- ufo %>%
separate(datetime, into = c("day", "month","year"), sep="/") %>%
separate(year, into = c("year", "time"), sep = " ") %>%
select(-duration_hours_min, -comments, -date_posted) %>%
mutate(year==as.factor(year))
ufo2 <- ufo %>%
separate(datetime, into = c("day", "month","year"), sep="/") %>%
separate(year, into = c("year", "time"), sep = " ") %>%
select(-duration_hours_min, -comments, -date_posted) %>%
mutate(year=as.factor(year))
ufo2 <- ufo %>%
separate(datetime, into = c("day", "month","year"), sep="/") %>%
separate(year, into = c("year", "time"), sep = " ") %>%
select(-duration_hours_min, -comments, -date_posted) %>%
mutate(year=as.factor(year)) %>%
mutate(latitude=as.numeric(latitude)) %>%
mutate(longitude=as.numeric(longitude)) %>%
mutate(shape=as.factor(shape)) %>%
mutate(state=as.factor(state))
ufo2 <- ufo %>%
separate(datetime, into = c("day", "month","year"), sep="/") %>%
separate(year, into = c("year", "time"), sep = " ") %>%
select(-duration_hours_min, -comments, -date_posted) %>%
mutate(year=as.factor(year)) %>%
mutate(latitude=as.numeric(latitude)) %>%
mutate(longitude=as.numeric(longitude)) %>%
mutate(shape=as.factor(shape)) %>%
mutate(state=as.factor(state)) %>%
filter(country=="us", latitude!=0, longitude!=0)
ufo2
View(ufo)
register_stadiamaps("aff428bd-8ad7-4b69-8b6b-b34301483ba9", write = FALSE)
ufo2 %>%
select(latitude, longitude) %>%
summary()
latitude <- c(17.97, 70.67)
longitude <- c(-176.66, -65.83)
alien_bbox <- make_bbox(longitude, latitude, f = 0.03)
alien_map <-  get_stadiamap(alien_bbox, maptype = "stamen_terrain", zoom=5)
ggmap(alien_map) +
geom_point(data = ufo2, aes(longitude, latitude), size=0.1) +
labs(x= "Longitude", y= "Latitude", title="UFO Sightings in the U.S")
names(ufo2)
ufo2 %>%
group_by(year) %>%
summarise(sightings = n()) %>%
arrange(desc(sightings))
ufo2 %>%
group_by(year) %>%
summarise(sightings = n()) %>%
arrange(desc(sightings))
sightings_summary <- ufo2 %>%
filter(!is.na(year)) %>%
group_by(year) %>%
summarise(sightings = n())
View(sightings_summary)
ggplot(sightings_summary, aes(x = year, y = sightings, group = year, na.rm = T))+
geom_col(position = "dodge", na.rm = T)+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
ggplot(sightings_summary, aes(x = year, y = sightings, group = year, na.rm = T))+
geom_col(position = "dodge", na.rm = T)+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme(axis.text.x=element_text(angle=60, hjust=1))+
theme_minimal()
ggplot(sightings_summary, aes(x = year, y = sightings, group = year, na.rm = T))+
geom_col(position = "dodge", na.rm = T)+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme(axis.text.x=element_text(angle=60, hjust=1))+
theme_minimal()
ggplot(sightings_summary, aes(x = year, y = sightings, group = year, na.rm = T))+
geom_col(position = "dodge", na.rm = T)+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme(axis.text.x=element_text(angle=70, hjust=1))+
theme_minimal()
ggplot(sightings_summary, aes(x = year, y = sightings))+
geom_line()+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
ggplot(sightings_summary, aes(x = year, y = sightings))+
geom_line()+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")
ufo2_avg_time <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0)) %>%
group_by(state) %>%
summarise(avg_secs = mean(duration_seconds))
View(ufo2_avg_time)
ufo2_avg_time <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0)) %>%
group_by(state) %>%
summarise(avg_secs = mean(duration_seconds))
ufo2_avg_time
names(ufo2)
ufo2 %>%
group_by(year) %>%
summarise(sightings = n()) %>%
arrange(desc(sightings))
sightings_summary <- ufo2 %>%
filter(!is.na(year)) %>%
group_by(year) %>%
summarise(sightings = n())
ggplot(sightings_summary, aes(x = year, y = sightings, group = year, na.rm = T))+
geom_col(position = "dodge", na.rm = T)+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
#theme(axis.text.x=element_text(angle=60, hjust=1))+ This line wasn't working : /
theme_minimal()
ggplot(sightings_summary, aes(x = year, y = sightings))+
geom_line()+
labs(title = "UFO Sightings Over the Years (1910-2014)",
x= "Year",
y = "Number of Sightings")+
theme_minimal()
ufo2_avg_time <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0)) %>%
group_by(state) %>%
summarise(avg_secs = mean(duration_seconds))
ufo2_avg_time
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_boxplot()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2_avg_time %>%
filter(state != "az") %>%
ggplot(aes(x = state, y = avg_secs))+
geom_boxplot()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2_avg_time %>%
filter(state != "az", state != "ar") %>%
ggplot(aes(x = state, y = avg_secs))+
geom_boxplot()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_bar()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_col()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2_avg_time <- ufo2 %>%
filter(!is.na(duration_seconds & duration_seconds != 0)) %>%
group_by(state) %>%
summarise(avg_secs = mean(duration_seconds)) %>%
arrange(desc(avg_secs))
ufo2_avg_time
ufo2_avg_time %>%
ggplot(aes(x = state, y = avg_secs))+
geom_col()+
labs(title = "Average Duration of UFO Sightings by State",
x = "State",
y= "Duration (Seconds)")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2 %>%
group_by(state) %>%
summarise(n_sightings = n()) %>%
arrange(desc(n_sightings))
ufo2 %>%
group_by(state) %>%
summarise(n_sightings = n()) %>%
arrange(desc(n_sightings)) %>%
ggplot(aes(x = state, y = n_sightings))+
geom_col()+
labs(title = "Total Recorded UFO Sightings by State",
x = "State",
y= "Number of Sightings")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2 %>%
group_by(shape) %>%
summarise(n_sightings = n()) %>%
arrange(desc(n_sightings))
ufo2 %>%
group_by(shape) %>%
summarise(n_sightings = n()) %>%
arrange(desc(n_sightings)) %>%
ggplot(aes(x = state, y = n_sightings))+
geom_col()+
labs(title = "Total Recorded UFO Sightings by Sighting Shape",
x = "Shape",
y= "Number of Sightings")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2 %>%
group_by(shape) %>%
summarise(n_sightings = n()) %>%
arrange(desc(n_sightings)) %>%
ggplot(aes(x = shape, y = n_sightings))+
geom_col()+
labs(title = "Total Recorded UFO Sightings by Sighting Shape",
x = "Shape",
y= "Number of Sightings")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ufo2 %>%
filter(!is.na(shape)) %>%
group_by(shape) %>%
summarise(n_sightings = n()) %>%
arrange(desc(n_sightings)) %>%
ggplot(aes(x = shape, y = n_sightings))+
geom_col()+
labs(title = "Total Recorded UFO Sightings by Sighting Shape",
x = "Shape",
y= "Number of Sightings")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
